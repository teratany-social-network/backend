{
    "tags": [
        {
            "name": "file",
            "description": "Interagir avec le serveur de fichier"
        },
        {
            "name": "authentication",
            "description": "API d'authentification Teratany"
        },
        {
            "name": "user",
            "description": "API d'utilisateur Teratany"
        }
    ],
    "openapi": "3.0.0",
    "info": {
        "title": "Teratany API",
        "version": "1.0.0"
    },
    "components": {
        "securitySchemes": {
            "bearerAuth": {
                "type": "http",
                "scheme": "bearer",
                "bearerFormat": "JWT"
            }
        }
    },
    "security": [
        {
            "bearerAuth": []
        }
    ],
    "paths": {
        "/user/authentication/verifyEmail": {
            "post": {
                "tags": [
                    "authentication"
                ],
                "summary": "Permet de verifier qu'un utilisateur est bel et bien le propriétaire de l'email",
                "description": "un email a été envoyé à l'utilisateur contenat le code de vérification. Pour permettre à l'utilisateur de confirmer que le mail est bel et bien le sien, il doit fournir le mail suivi du code qui lui a été envoyé",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "description": "L'adresse email a verifier.",
                                        "example": "example@mail.org"
                                    },
                                    "code": {
                                        "type": "number",
                                        "description": "Le code de confirmation.",
                                        "example": 123456
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "ok"
                    },
                    "500": {
                        "description": "Une erreur serveur s'est produite"
                    }
                }
            }
        },
        "/user/authentication/signup": {
            "post": {
                "tags": [
                    "authentication"
                ],
                "summary": "Création de compte Teratany",
                "description": "le formulaire de création de compte, il retourne soit un token JWT",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "description": "L'adresse email de l'utilisateur, un email ne peut être utilisé qu'une seule fois",
                                        "example": "example@mail.org"
                                    },
                                    "displayName": {
                                        "type": "string",
                                        "description": "Minimum 2 caractères, maximum 32. Doit être unique",
                                        "example": "Jon Doe 64"
                                    },
                                    "password": {
                                        "type": "string",
                                        "description": "Minimum 4 caractères. Un mot de passe complexe est recommandé pour plus de sécurité",
                                        "example": "Pass1234"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "un token JWT"
                    }
                }
            }
        },
        "/user/authentication/checkName": {
            "get": {
                "tags": [
                    "authentication"
                ],
                "summary": "Verifier la disponnibilité du nom",
                "description": "retourne true sy le nom est libre et false si le nom est utilisé par quelqu'un",
                "parameters": [
                    {
                        "in": "query",
                        "name": "displayName",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Le nom à verifier",
                        "example": "Jon Doe 69"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "true sy le nom est libre et false si le nom est utilisé par quelqu'un"
                    }
                }
            }
        },
        "/user/authentication/checkEmail": {
            "get": {
                "tags": [
                    "authentication"
                ],
                "summary": "Verifier la disponnibilité de l'email",
                "description": "retourne true sy le mail est libre et false sinon",
                "parameters": [
                    {
                        "in": "query",
                        "name": "email",
                        "schema": {
                            "type": "string"
                        },
                        "description": "Le nom à verifier",
                        "example": "example@mail.com"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "true sy le mail est libre et false sinon"
                    }
                }
            }
        },
        "/user/authentication/sendEmail": {
            "post": {
                "tags": [
                    "authentication"
                ],
                "summary": "Envoie un email de confirmation à l'adresse email utilisé à la création de compte",
                "description": "Le mail contient un code de confirmation",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "description": "L'adresse email de l'utilisateur",
                                        "example": "example@mail.org"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "un token JWT"
                    }
                }
            }
        },
        "/user/authentication/signin": {
            "post": {
                "tags": [
                    "authentication"
                ],
                "summary": "Connexion à un compte Teratany",
                "description": "le formulaire de connexion, il retourne soit un token JWT",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "description": "L'adresse email de l'utilisateur",
                                        "example": "example@mail.org"
                                    },
                                    "password": {
                                        "type": "string",
                                        "description": "Son mot de passe",
                                        "example": "Pass1234"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "un token JWT"
                    }
                }
            }
        },
        "/user/{id}": {
            "get": {
                "tags": [
                    "user"
                ],
                "summary": "Verifier la disponnibilité du nom",
                "description": "retourne true sy le nom est libre et false si le nom est utilisé par quelqu'un",
                "parameters": [
                    {
                        "in": "path",
                        "name": "id",
                        "schema": {
                            "type": "string"
                        },
                        "description": "L'identifiant à rechercher",
                        "example": "6528f7d0ec2defa28afe1ee4"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Les informations publique de l'utilisateur"
                    }
                }
            }
        },
        "/user/": {
            "get": {
                "tags": [
                    "user"
                ],
                "summary": "Recherche d'utilisateur",
                "description": "Recherche d'utilisateur, retourne une liste des utilisateurs correspondant au filter de recherche",
                "parameters": [
                    {
                        "in": "query",
                        "name": "filter",
                        "schema": {
                            "type": "string"
                        },
                        "description": "nom ou email"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "liste des utilisateurs correspondant"
                    }
                }
            }
        },
        "/user/displayName": {
            "get": {
                "tags": [
                    "user"
                ],
                "summary": "Recherche dun utilisateur par son displayName",
                "description": "Recherche d'utilisateur, retourne les donnée de l'utilisateur sinon retourne une erreur",
                "parameters": [
                    {
                        "in": "query",
                        "name": "displayName",
                        "schema": {
                            "type": "string"
                        },
                        "description": "nom de l'utilisateur"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "l'utilisateurs correspondant"
                    }
                }
            }
        },
        "/user/email": {
            "get": {
                "tags": [
                    "user"
                ],
                "summary": "Recherche dun utilisateur par son email",
                "description": "Recherche d'utilisateur, retourne les donnée de l'utilisateur sinon retourne une erreur",
                "parameters": [
                    {
                        "in": "query",
                        "name": "email",
                        "schema": {
                            "type": "string"
                        },
                        "description": "email l'utilisateur"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "l'utilisateurs correspondant"
                    }
                }
            }
        },
        "/user/withCoordonates": {
            "get": {
                "tags": [
                    "user"
                ],
                "summary": "La liste des utilisateurs ayant mis leurs position géographique en public",
                "description": "La liste des utilisateurs ayant mis leurs position géographique en public",
                "responses": {
                    "200": {
                        "description": "l'utilisateurs correspondant"
                    }
                }
            }
        },
        "/user/byToken": {
            "get": {
                "tags": [
                    "user"
                ],
                "security": [
                    {
                        "bearerAuth": []
                    }
                ],
                "summary": "Voir les information de l'utilisateur connecté",
                "description": "Recherche d'utilisateur, retourne les donnée de l'utilisateur sinon retourne une erreur",
                "responses": {
                    "200": {
                        "description": "l'utilisateurs connecté"
                    }
                }
            }
        },
        "/user/password/recovery": {
            "get": {
                "tags": [
                    "user"
                ],
                "summary": "Envoyer email pour récuperer le mot de passe de l'utilisateur",
                "description": "Un code de confirmation sera envoyé par email à l'utilisateur.",
                "parameters": [
                    {
                        "in": "query",
                        "name": "email",
                        "schema": {
                            "type": "string"
                        },
                        "description": "email l'utilisateur"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "le mail a été envoyé"
                    }
                }
            },
            "patch": {
                "tags": [
                    "user"
                ],
                "summary": "Modifier le mot de passe",
                "description": "Modifier le mot de passe",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "password": {
                                        "type": "string",
                                        "description": "Le nouveau mot de passe",
                                        "example": "Pass1234"
                                    },
                                    "email": {
                                        "type": "string",
                                        "description": "le mail de la personne qui va recuperer son mot de passe",
                                        "example": "example@mail.com"
                                    },
                                    "code": {
                                        "type": "string",
                                        "description": "Le code reçu par email"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Mot de passe récupéré"
                    }
                }
            }
        },
        "/user/profileImage/": {
            "patch": {
                "tags": [
                    "user"
                ],
                "summary": "Modifier la photo de profil, reçoit l'url de la photo",
                "description": "Cette terminaison permer de changer la photo de profil d'une personne connecté, en envoyant le token JWT et le lien de la photo",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "imageUrl": {
                                        "type": "string",
                                        "description": "Lien de l'image"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Photo de profil modifié"
                    }
                }
            }
        },
        "/user/password/": {
            "patch": {
                "tags": [
                    "user"
                ],
                "summary": "Modifier le mot de passe",
                "description": "Modifier le mot de passe",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "password": {
                                        "type": "string",
                                        "description": "Le mot de passe actuel",
                                        "example": "Pass1234"
                                    },
                                    "newPassword": {
                                        "type": "string",
                                        "description": "Le nouveau mot de passe",
                                        "example": "Pass1234"
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Mot de passe modifié"
                    }
                }
            }
        },
        "/upload": {
            "post": {
                "tags": [
                    "file"
                ],
                "summary": "Upload and Resize Image",
                "consumes": [
                    "multipart/form-data"
                ],
                "produces": [
                    "application/json"
                ],
                "requestBody": {
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "type": "object",
                                "properties": {
                                    "images": {
                                        "type": "string",
                                        "format": "binary"
                                    }
                                }
                            },
                            "encoding": {
                                "profileImage": {
                                    "contentType": "image/png, image/jpeg",
                                    "headers": {
                                        "X-Custom-Header": {
                                            "description": "This is a custom header",
                                            "schema": {
                                                "type": "string"
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Successful operation"
                    },
                    "400": {
                        "description": "Bad request. No file uploaded."
                    },
                    "500": {
                        "description": "Internal server error"
                    }
                }
            }
        },
        "/public/{filename}": {
            "get": {
                "tags": [
                    "file"
                ],
                "summary": "Télécharger une image",
                "parameters": [
                    {
                        "in": "path",
                        "name": "filename",
                        "schema": {
                            "type": "string"
                        },
                        "description": "nom du fichier",
                        "example": "resized-1697742894161-Screenshot 2023-10-11 153003.png"
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Successful operation",
                        "content": {
                            "image/png": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            },
                            "image/jpeg": {
                                "schema": {
                                    "type": "string",
                                    "format": "binary"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Image not found"
                    }
                }
            }
        }
    }
}